<!doctype html>

<html lang="ko">

<head>

  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />



  <title>í‹° í…Œë¼í”¼ (Tea Therapy)</title>

  <meta property="og:title" content="í‹° í…Œë¼í”¼ (Tea Therapy)" />

  <meta property="og:description" content="ë‚´ ëª¸ê³¼ ë§ˆìŒì— ë”± ë§ëŠ” ì°¨ë¥¼ ì²˜ë°©ë°›ìœ¼ì„¸ìš”." />

  <meta property="og:image" content="https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?q=80&w=1200&auto=format&fit=crop" />



  <!-- í°íŠ¸ & ë¼ì´ë¸ŒëŸ¬ë¦¬ -->

  <link href="https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&family=Pretendard:wght@400;600;700&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>



  <style>

    /* [ê¸°ë³¸ ì„¤ì •] */

    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Pretendard', sans-serif; -webkit-tap-highlight-color: transparent; }



    body {

      background: url('./tea.jpeg') no-repeat center center fixed;

      background-size: cover;

      color: #333;

      display: flex; justify-content: center; align-items: center;

      min-height: 100vh; padding: 20px 10px;

      backdrop-filter: blur(2px);

    }



    /* [ì¹´ë“œ ì»¨í…Œì´ë„ˆ] */

    .wrap { width: 100%; max-width: 460px; }

    .card {

      background: rgba(255, 255, 255, 0.96);

      border-radius: 24px;

      padding: 28px 24px;

      box-shadow: 0 10px 40px rgba(0,0,0,0.25);

      min-height: 680px;

      display: flex; flex-direction: column; position: relative;

    }



    /* [í—¤ë”] */

    header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px; }

    h1 { font-family: 'Nanum Pen Script', cursive; font-size: 34px; color: #2e7d32; line-height: 1.1; margin-bottom: 4px; }

    .sub { font-size: 14px; color: #666; font-weight: 500; }

    .icon-btn { background: none; border: none; padding: 8px; cursor: pointer; border-radius: 50%; transition: background 0.2s; color: #555; }

    .icon-btn:hover { background: #f0f0f0; }



    /* [ì§„í–‰ ìƒíƒœ] */

    .pill { display: inline-block; padding: 5px 14px; background: #e8f5e9; color: #2e7d32; border-radius: 20px; font-size: 12px; font-weight: 700; margin-bottom: 12px; }

    .bar { width: 100%; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; margin-bottom: 24px; }

    #barFill { height: 100%; background: #2f8a58; width: 0%; transition: width 0.4s ease; }



    /* [ë²„íŠ¼ ìŠ¤íƒ€ì¼] */

    .wide-btn { width: 100%; background: #fff; border: 1px solid #e0e0e0; padding: 20px; border-radius: 16px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; transition: 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.03); margin-bottom: 10px; }

    .wide-btn:hover { border-color: #2f8a58; background: #fdfdfd; transform: translateY(-2px); }

    .wide-btn strong { display: block; font-size: 16px; color: #333; margin-bottom: 4px; }

    .wide-btn span { font-size: 13px; color: #888; font-weight: 400; text-align: left; }



    .nav { margin-top: auto; display: flex; gap: 8px; padding-top: 20px; }

    .btn { flex: 1; padding: 15px; border-radius: 14px; border: none; font-weight: 700; cursor: pointer; transition: 0.2s; background: #f5f5f5; color: #666; font-size: 14px; }

    .btn.primary { background: #A0BAED; color: white; box-shadow: 0 4px 12px rgba(47, 138, 88, 0.3); }

    .btn.capture { background: #9FC93C; color: white; }

    .btn.danger { background: #fff0f0; color: #d32f2f; }

    .btn:hover { transform: translateY(-2px); opacity: 0.95; }



    /* [ë§› ì„ íƒ ê·¸ë¦¬ë“œ] */

    .taste-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 10px; }

    .taste-btn { 

        background: #fff; border: 1px solid #ddd; border-radius: 20px; padding: 24px 10px; text-align: center; cursor: pointer; transition: 0.2s; 

        display: flex; flex-direction: column; align-items: center; justify-content: center; 

    }

    .taste-btn:hover { border-color: #2f8a58; background: #f9fffb; transform: translateY(-2px); }

    /* taste-img ìŠ¤íƒ€ì¼ ìˆ˜ì •: í¬ê¸° ëŒ€í­ í™•ëŒ€ */

    .taste-img { width: 120px; height: 120px; object-fit: contain; margin-bottom: 12px; }

    .taste-btn strong { font-size: 18px; }



    /* [ë°”ë”” ìŠ¤ìºë„ˆ: ì¢Œìš° ë°°ì¹˜ ë ˆì´ì•„ì›ƒ] */

    .scanner-layout {

        display: flex;

        align-items: center;

        gap: 10px; /* ê°„ê²© ì¤„ì„ */

        margin: 10px 0 20px;

    }

    .scanner-left {

        flex: 0 0 180px; /* ì‚¬ëŒ ê·¸ë¦¼ ì˜ì—­ ëŒ€í­ í™•ëŒ€ */

        display: flex;

        justify-content: center;

    }

    .body-svg {

        width: 100%;

        height: auto;

        /* ê·¸ë¦¼ì íš¨ê³¼ */

        filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));

    }



    .scanner-right {

        flex: 1; /* ë‚˜ë¨¸ì§€ ê³µê°„ */

        display: flex;

        flex-direction: column;

        gap: 6px; /* ë²„íŠ¼ ì‚¬ì´ ê°„ê²© ì¢í˜ */

    }



    /* ë²„íŠ¼ í¬ê¸° ì¶•ì†Œ ìŠ¤íƒ€ì¼ */

    .part-btn {

        background: #fff;

        border: 1px solid #ddd;

        padding: 10px 10px; /* íŒ¨ë”© ì¤„ì„ */

        border-radius: 10px;

        text-align: left;

        font-size: 13px; /* í°íŠ¸ ì‚¬ì´ì¦ˆ ì¤„ì„ */

        font-weight: 600;

        color: #555;

        cursor: pointer;

        transition: 0.2s;

        display: flex; justify-content: space-between; align-items: center;

    }

    .part-btn:hover, .part-btn.active {

        background: #2f8a58;

        color: #fff;

        border-color: #2f8a58;

    }

    

    /* í•˜ì´ë¼ì´íŠ¸ ìŠ¤íƒ€ì¼ */

    .hlt { opacity: 0; transition: 0.2s; fill: rgba(47, 138, 88, 0.4); stroke: #2f8a58; stroke-width: 3; }

    .hlt.on { opacity: 1; }



    /* [ì¦ìƒ ë¦¬ìŠ¤íŠ¸] */

    .symptom-list { display: flex; flex-direction: column; gap: 10px; margin-top: 10px; }

    .symptom-btn { width: 100%; background: #fff; border: 1px solid #ddd; padding: 18px 16px; border-radius: 14px; text-align: left; font-size: 15px; color: #444; transition: 0.2s; font-weight: 500; display: flex; justify-content: space-between; align-items: center; }

    .symptom-btn:hover { background: #2f8a58; color: #fff; border-color: #2f8a58; transform: translateX(5px); }



    /* [ê²°ê³¼ í™”ë©´] */

    .result .box { background: #fff; border-radius: 20px; margin-bottom: 16px; padding: 24px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); text-align: center; }

    .result-title { font-size: 14px; color: #2f8a58; font-weight: 700; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }

    .tea-name { font-size: 28px; margin: 0 0 10px; color: #222; font-family: 'Nanum Pen Script', cursive; }

    .tea-desc { color: #555; line-height: 1.6; margin-bottom: 20px; word-break: keep-all; font-size: 15px; }



    .recipe-card { border-radius: 12px; margin-top: 12px; text-align: left; padding: 16px; position: relative; font-size: 14px; line-height: 1.5; }

    .recipe-card.original { background: #fffbf5; border: 1px dashed #d68c00; }

    .recipe-card.modified { background: #f1f8e9; border: 1px dashed #2f8a58; }

    

    .recipe-label { font-size: 11px; font-weight: bold; margin-bottom: 6px; display: inline-block; padding: 2px 8px; border-radius: 4px; }

    .recipe-label.og { background: #d68c00; color: #fff; }

    .recipe-label.mod { background: #2f8a58; color: #fff; }



    .tag-container { margin-top: 20px; display: flex; justify-content: center; gap: 6px; flex-wrap: wrap; }

    .tag { background: #e8f5e9; color: #2e7d32; padding: 6px 12px; border-radius: 8px; font-size: 13px; font-weight: 600; }



    /* [í‘¸í„° & ëª¨ë‹¬] */

    .footer { text-align: center; margin-top: 20px; color: #888; font-size: 11px; line-height: 1.5; }

    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 100; backdrop-filter: blur(3px); }

    .hidden { display: none; }

    .modal-box { background: white; padding: 24px; border-radius: 16px; width: 300px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }

    .qr-img { width: 160px; height: 160px; margin: 16px 0; }

    .url-input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 16px; text-align: center; color: #666; font-size: 12px; background: #f9f9f9; }



    @media (max-width: 360px) {

      h1 { font-size: 28px; }

      /* ëª¨ë°”ì¼ì—ì„œëŠ” ì„¸ë¡œë¡œ ë°°ì¹˜í•˜ëŠ”ê²Œ ë‚˜ì„ ìˆ˜ë„ ìˆì§€ë§Œ, ìš”ì²­ëŒ€ë¡œ ìœ ì§€í•˜ë˜ ë¹„ìœ¨ ì¡°ì • */

      .scanner-left { flex: 0 0 160px; }

    }

  </style>

</head>



<body>

  <div class="wrap">

    <div class="card" id="app">

      <header>

        <div class="header-left">

          <h1 id="pageTitle">í‹° í…Œë¼í”¼</h1>

          <div class="sub" id="pageSub">ì˜¤ëŠ˜ì˜ ë‚˜ì—ê²Œ í•„ìš”í•œ ì°¨ë¥¼ ì²˜ë°©í•©ë‹ˆë‹¤.</div>

        </div>

        <div class="header-right">

          <button class="icon-btn" onclick="location.href='index.html'">ğŸ </button>

          <button class="icon-btn" onclick="openShareModal()" aria-label="ê³µìœ í•˜ê¸°">

            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="20" height="20">

              <circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle>

              <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>

            </svg>

          </button>

        </div>

      </header>



      <div style="margin-bottom:10px;"><div class="pill" id="stepPill">Menu</div></div>

      <div class="bar"><div id="barFill"></div></div>



      <main id="mainContent" style="flex:1; display:flex; flex-direction:column;"></main>



      <div class="footer">

        <div>Â© ìì—°í™˜ê²½í•´ì„¤ì‚¬ ì •ì£¼í¬</div>

        <div>* ì˜í•™ì  ì§„ë‹¨ì´ ì•„ë‹Œ ì·¨í–¥/ì»¨ë””ì…˜ ê¸°ë°˜ ì¶”ì²œì…ë‹ˆë‹¤.</div>

      </div>

    </div>

  </div>



  <!-- ê³µìœ  ëª¨ë‹¬ -->

  <div id="shareModal" class="modal-overlay hidden" onclick="closeShareModal(event)">

    <div class="modal-box" onclick="event.stopPropagation()">

      <h3>QRì½”ë“œ ê³µìœ </h3>

      <img id="qrImage" src="" alt="QR Code" class="qr-img">

      <input type="text" id="shareUrlInput" class="url-input" readonly>

      <div style="display:flex; gap:8px;">

        <button class="btn primary" style="flex:1" onclick="copyShareUrl()">ì£¼ì†Œ ë³µì‚¬</button>

        <button class="btn" style="flex:1" onclick="closeShareModal()">ë‹«ê¸°</button>

      </div>

    </div>

  </div>



<script>

(() => {

  // [TEA DATABASE]

  const TEA_DB = {

    head: {

      label: "ë¨¸ë¦¬ / ì •ì‹ ",

      symptoms: [

        { txt: "ìƒê°ì´ ë§ê³  ë¨¸ë¦¬ê°€ ë¬´ê±°ì›€", tea: "ë°•í•˜ì°¨", desc: "ë°•í•˜ì˜ ë©˜í†¨ ì„±ë¶„ì´ ë§‰íŒ ê¸°ìš´ì„ ëš«ì–´ì£¼ê³  ë¨¸ë¦¬ë¥¼ ë§‘ê²Œ í•©ë‹ˆë‹¤.", recipe: "ë°•í•˜ì 2g + ë”°ëœ»í•œ ë¬¼ 200ml (3ë¶„ ìš°ë¦¼)", tags: ["ë‘í†µ", "ë¦¬í”„ë ˆì‹œ"], taste: "cooling" },

        { txt: "ëˆˆì´ ì¹¨ì¹¨í•˜ê³  í”¼ë¡œí•¨", tea: "ê²°ëª…ìì°¨", desc: "ê²°ëª…ìëŠ” 'ëˆˆì„ ë°ê²Œ í•˜ëŠ” ì”¨ì•—'ì…ë‹ˆë‹¤. ìŠ¤ë§ˆíŠ¸í°ìœ¼ë¡œ ì§€ì¹œ ëˆˆì— íœ´ì‹ì„ ì£¼ì„¸ìš”.", recipe: "ë³¶ì€ ê²°ëª…ì 1í°ìˆ  + ëœ¨ê±°ìš´ ë¬¼ 300ml", tags: ["ëˆˆí”¼ë¡œ", "ì—´ë‚´ë¦¼"] },

        { txt: "í™”ê°€ ë‚˜ê³  ì—´ì´ ë»—ì¹¨", tea: "ì¹˜ìì°¨", desc: "ê°€ìŠ´ ì†ì˜ í™”(ç«)ë¥¼ ë‚´ë ¤ì£¼ê³  ë§ˆìŒì„ ì§„ì •ì‹œì¼œ ì¤ë‹ˆë‹¤.", recipe: "ë§ë¦° ì¹˜ì 1ê°œ(ë¶€ì…”ì„œ) + ê°ì´ˆ í•œ ì¡°ê° + ë¬¼ 300ml", tags: ["í™”ë³‘", "ì§„ì •"] },

        { txt: "ì§‘ì¤‘ë ¥ì´ í•„ìš”í•¨", tea: "ë…¹ì°¨", desc: "ì€ì€í•œ ì¹´í˜ì¸ì´ ì •ì‹ ì„ ê¹¨ìš°ê³ , ì¹´í…Œí‚¨ì´ ëª¸ì„ ê°€ë³ê²Œ í•©ë‹ˆë‹¤.", recipe: "ë…¹ì°¨ ì 1í‹°ìŠ¤í‘¼ + 70~80ë„ ë¬¼ (ë„ˆë¬´ ëœ¨ê²ì§€ ì•Šê²Œ)", tags: ["ì§‘ì¤‘", "ë§‘ìŒ"] }

      ]

    },

    throat: {

      label: "ëª© / ê¸°ê´€ì§€",

      symptoms: [

        { txt: "ëª©ì´ ë”°ê°‘ê³  ì¹¼ì¹¼í•¨", tea: "ë„ë¼ì§€ ê°ì´ˆì°¨", desc: "ë„ë¼ì§€ì˜ ì‚¬í¬ë‹Œì´ ê¸°ê´€ì§€ë¥¼ ë³´í˜¸í•˜ê³ , ê°ì´ˆê°€ ëª©ì„ ë¶€ë“œëŸ½ê²Œ ê°ì‹¸ì¤ë‹ˆë‹¤.", recipe: "ë§ë¦° ë„ë¼ì§€ 5g + ê°ì´ˆ 2ì¡°ê° + ë¬¼ 500ml ë“ì´ê¸°", tags: ["ëª©ê°ê¸°", "ê¸°ê´€ì§€"], taste: "sweet" },

        { txt: "ìœ¼ìŠ¬ìœ¼ìŠ¬ ê°ê¸° ê¸°ìš´", tea: "ìœ ìì°¨", desc: "ë¹„íƒ€ë¯¼ Cê°€ ê°€ë“í•œ ë”°ëœ»í•œ ìœ ìì°¨ë¡œ ë©´ì—­ë ¥ì„ ì¶©ì „í•˜ì„¸ìš”.", recipe: "ìœ ìì²­ 2í°ìˆ  + ëœ¨ê±°ìš´ ë¬¼ 250ml", tags: ["ê°ê¸°", "ë¹„íƒ€ë¯¼"], taste: "sour" },

        { txt: "ë§ˆë¥¸ ê¸°ì¹¨ì´ ê³„ì†ë¨", tea: "ì˜¤ë¯¸ìì°¨", desc: "ë‹¤ì„¯ ê°€ì§€ ë§›ì„ ê°€ì§„ ì˜¤ë¯¸ìëŠ” íë¥¼ ì´‰ì´‰í•˜ê²Œ ì ì…”ì¤ë‹ˆë‹¤.", recipe: "ê±´ì˜¤ë¯¸ì 10g + ì°¬ë¬¼ 500ml (í•˜ë£¨ ëƒ‰ì¹¨ í›„ ë”°ëœ»í•˜ê²Œ ë°ì›Œë“œì„¸ìš”)", tags: ["ê¸°ì¹¨", "íê±´ê°•"], taste: "sour" }

      ]

    },

    upper: {

      label: "ìœ—ë°° / ìœ„, ê°„",

      symptoms: [

        { txt: "ì†ì´ ë”ë¶€ë£©í•˜ê³  ì†Œí™” ì•ˆë¨", tea: "ë§¤ì‹¤ì°¨", desc: "ë§¤ì‹¤ì˜ ì‹ ë§›ì´ ìœ„ì‚° ë¶„ë¹„ë¥¼ ì¡°ì ˆí•˜ê³  ì†Œí™”ë¥¼ ë•ìŠµë‹ˆë‹¤.", recipe: "ë§¤ì‹¤ì²­ 2í°ìˆ  + ë”°ëœ»í•œ ë¬¼ 200ml", tags: ["ì†Œí™”ë¶ˆëŸ‰", "ì²´ê¸°"], taste: "sour" },

        { txt: "ê¸°ë¦„ì§„ ìŒì‹, ê³¼ì‹", tea: "ë³´ì´ì°¨", desc: "ì§€ë°©ì„ ë¶„í•´í•˜ê³  ì†ì„ í¸ì•ˆí•˜ê²Œ ì”»ì–´ë‚´ë ¤ ì¤ë‹ˆë‹¤.", recipe: "ë³´ì´ì°¨ í‹°ë°±/ì + ë“ëŠ” ë¬¼ (ì²« ë¬¼ì€ ë²„ë¦¬ê³  ë‘ë²ˆì§¸ë¶€í„° ìŒìš©)", tags: ["ë‹¤ì´ì–´íŠ¸", "ì§€ë°©ë¶„í•´"] },

        { txt: "í”¼ë¡œí•˜ê³  ìˆ™ì·¨ê°€ ìˆìŒ", tea: "í—›ê°œë‚˜ë¬´ì°¨", desc: "ê°„ì˜ ë…ì†Œë¥¼ í’€ì–´ì£¼ì–´ í”¼ë¡œ íšŒë³µê³¼ ìˆ™ì·¨ í•´ì†Œì— ì¢‹ìŠµë‹ˆë‹¤.", recipe: "í—›ê°œë‚˜ë¬´ ì¡°ê° + ë¬¼ ë„£ê³  20ë¶„ ì´ìƒ ë“ì´ê¸°", tags: ["ìˆ™ì·¨", "ê°„ë³´í˜¸"] }

      ]

    },

    lower: {

      label: "ì•„ë«ë°° / ëŒ€ì¥, ì‹ ì¥",

      symptoms: [

        { txt: "ë°°ê°€ ì°¨ê°‘ê³  ì‚´ì‚´ ì•„í””", tea: "ìƒê°•ì°¨", desc: "ìƒê°•ì˜ ë§¤ìš´ë§›ì´ ì•„ë«ë°°ë¥¼ ë”°ëœ»í•˜ê²Œ ë°ì›Œ ëƒ‰ê¸°ë¥¼ ëª°ì•„ëƒ…ë‹ˆë‹¤.", recipe: "ìƒê°•ì²­ 1í°ìˆ  ë˜ëŠ” í¸ìƒê°• 3ìª½ + ê¿€ + ëœ¨ê±°ìš´ ë¬¼", tags: ["ë³µí†µ", "ëƒ‰ì¦"], taste: "spicy" },

        { txt: "í™”ì¥ì‹¤ ê°€ê¸°ê°€ í˜ë“¦ (ë³€ë¹„)", tea: "ìš°ì—‰ì°¨", desc: "ì‹ì´ì„¬ìœ ê°€ í’ë¶€í•œ ìš°ì—‰ì€ ì¥ ìš´ë™ì„ í™œë°œí•˜ê²Œ í•©ë‹ˆë‹¤.", recipe: "ë³¶ì€ ìš°ì—‰ 3-4ì¡°ê° + ëœ¨ê±°ìš´ ë¬¼ (êµ¬ìˆ˜í•œ ë§›ì´ ë‚  ë•Œê¹Œì§€)", tags: ["ë³€ë¹„", "ë””í†¡ìŠ¤"] },

        { txt: "ëª¸ì´ ì˜ ë¶“ìŒ (ì‹ ì¥)", tea: "ì˜¥ìˆ˜ìˆ˜ìˆ˜ì—¼ì°¨", desc: "ì´ë‡¨ ì‘ìš©ì„ ë„ì™€ ë¶ˆí•„ìš”í•œ ìˆ˜ë¶„ê³¼ ë¶“ê¸°ë¥¼ ë¹¼ì¤ë‹ˆë‹¤.", recipe: "ì˜¥ìˆ˜ìˆ˜ìˆ˜ì—¼ í•œ ì¤Œ + ë¬¼ 500ml ë“ì´ê¸°", tags: ["ë¶“ê¸°", "ì´ë‡¨"] }

      ]

    },

    whole: {

      label: "ì „ì‹ ìˆœí™˜ (í˜ˆì•¡ìˆœí™˜)",

      symptoms: [

        { txt: "ì†ë°œì´ ì°¨ê³  ì €ë¦¼", tea: "ê³„í”¼ì°¨ (ìˆ˜ì •ê³¼)", desc: "ê³„í”¼ì˜ ë”°ëœ»í•œ ì„±ì§ˆì´ ë§ì´ˆ í˜ˆê´€ê¹Œì§€ í˜ˆì•¡ì„ ë³´ë‚´ì¤ë‹ˆë‹¤.", recipe: "í†µê³„í”¼ 1ëŒ€ + ìƒê°• ì•½ê°„ + í‘ì„¤íƒ• + ë¬¼ ë“ì´ê¸°", tags: ["ìˆ˜ì¡±ëƒ‰ì¦", "ìˆœí™˜"], taste: "spicy" },

        { txt: "ì˜¨ëª¸ì´ ë»ê·¼í•˜ê³  ì‘¤ì‹¬", tea: "ìŒí™”ì°¨", desc: "ê¸°ì™€ í˜ˆì„ ìŒìœ¼ë¡œ ì¡°í™”ë¡­ê²Œ í•˜ì—¬ í”¼ë¡œë¥¼ í’‰ë‹ˆë‹¤.", recipe: "ì‹œíŒ ìŒí™”ì²­ ë˜ëŠ” ìŒí™” í‹°ë°± + ì£/ëŒ€ì¶” ê³ ëª…", tags: ["ê·¼ìœ¡í†µ", "ë³´ì–‘"], taste: "sweet" },

        { txt: "ê¸´ì¥ ì™„í™”ê°€ í•„ìš”í•¨", tea: "ëŒ€ì¶”ì°¨", desc: "ëŒ€ì¶”ì˜ ë‹¨ë§›ì´ ê¸´ì¥ëœ ê·¼ìœ¡ê³¼ ì‹ ê²½ì„ ì´ì™„ì‹œì¼œ ì¤ë‹ˆë‹¤.", recipe: "ëŒ€ì¶”ê³  2í°ìˆ  + ëœ¨ê±°ìš´ ë¬¼", tags: ["ì´ì™„", "ë¶ˆë©´ì¦"], taste: "sweet" }

      ]

    }

  };



  const state = { 

    view: 'menu', 

    dislikedTaste: null,

    selectedCategory: null, 

    selectedResult: null 

  };



  const mainContent = document.getElementById("mainContent");

  const pageTitle = document.getElementById("pageTitle");

  const pageSub = document.getElementById("pageSub");

  const stepPill = document.getElementById("stepPill");

  const barFill = document.getElementById("barFill");



  // Highlight Logic

  window.setHighlight = (key, on) => {

    const el = document.getElementById('hlt-' + key);

    if (!el) return;

    el.classList.toggle('on', !!on);

    

    // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—°ë™

    const btn = document.getElementById('btn-' + key);

    if (btn) {

        if (on) btn.classList.add('active');

        else btn.classList.remove('active');

    }

  };



  function setTitle(title, sub, pill) {

    pageTitle.textContent = title;

    pageSub.textContent = sub;

    stepPill.textContent = pill;

  }



  function getModifiedRecipe(original, teaName, dislike) {

    if (dislike === 'none') return null;

    if (dislike === 'spicy') {

        if (teaName.includes('ìƒê°•') || teaName.includes('ê³„í”¼') || teaName.includes('ìŒí™”')) {

            return "ìƒê°•ì´ë‚˜ ê³„í”¼ì˜ ì–‘ì„ 1/3ë¡œ ì¤„ì´ê±°ë‚˜ ë¹¼ê³ , ëŒ€ì¶”ë¥¼ ë” ë„£ì–´ ë¶€ë“œëŸ½ê²Œ ë“œì„¸ìš”.";

        }

    }

    if (dislike === 'sour') {

        if (teaName.includes('ìœ ì') || teaName.includes('ì˜¤ë¯¸ì') || teaName.includes('ë§¤ì‹¤') || teaName.includes('ë ˆëª¬')) {

            return "ì—°í•˜ê²Œ í¬ì„í•´ì„œ ë“œì‹œê±°ë‚˜, ê¿€ì„ í‰ì†Œë³´ë‹¤ ë” ë„£ì–´ ì‹ ë§›ì„ ì¤‘í™”ì‹œí‚¤ì„¸ìš”.";

        }

    }

    if (dislike === 'sweet') {

        if (original.includes('ì²­') || original.includes('ì„¤íƒ•') || original.includes('ê¿€') || teaName.includes('ëŒ€ì¶”')) {

            return "ì²­ì´ë‚˜ ê¿€, ì„¤íƒ•ì„ ë¹¼ê³  ì›ë¬¼ ê·¸ëŒ€ë¡œ ìš°ë ¤ë‚´ì–´ ë‹´ë°±í•˜ê³  ê¹”ë”í•˜ê²Œ ë“œì„¸ìš”.";

        }

    }

    if (dislike === 'cooling') {

        if (teaName.includes('ë°•í•˜')) {

            return "ë°•í•˜ ìì˜ ì–‘ì„ ì ˆë°˜ìœ¼ë¡œ ì¤„ì´ê³ , ë”°ëœ»í•œ ì„±ì§ˆì˜ ì°¨(ë‘¥êµ´ë ˆ ë“±)ì™€ ë¸”ë Œë”©í•˜ì„¸ìš”.";

        }

    }

    return null; 

  }



  function render() {

    barFill.style.width = '0%';



    // 1. ë©”ì¸ ë©”ë‰´

    if (state.view === 'menu') {

      setTitle("í‹° í…Œë¼í”¼", "ì›í•˜ëŠ” ë©”ë‰´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.", "Menu");

      mainContent.innerHTML = `

        <button class="wide-btn" onclick="setView('select_taste')">

          <div style="flex:1;">

            <strong>ğŸ§˜ ë°”ë”” ìŠ¤ìºë„ˆ (Body Scan)</strong>

            <span>ë‚´ ëª¸ì˜ ë¶ˆí¸í•œ ê³³ì„ ì§šì–´ë³´ê³ <br>ì¦ìƒì— ë§ëŠ” ì°¨ë¥¼ ì¶”ì²œë°›ìŠµë‹ˆë‹¤.</span>

          </div>

          <div style="font-size:24px;">ğŸ©º</div>

        </button>

        <button class="wide-btn" onclick="alert('ì¤€ë¹„ ì¤‘ì¸ ê¸°ëŠ¥ì…ë‹ˆë‹¤.')">

          <div style="flex:1;">

             <strong>ğŸµ í‹° ë¸”ë Œë”© ë ˆì‹œí”¼</strong>

             <span>ë‚˜ë§Œì˜ ì°¨ë¥¼ ë§Œë“œëŠ” ë¸”ë Œë”© ê°€ì´ë“œ</span>

          </div>

          <div style="font-size:24px;">ğŸ¥£</div>

        </button>

      `;

    }

    // 2. ì‹«ì–´í•˜ëŠ” ë§› ì„ íƒ

    else if (state.view === 'select_taste') {

      barFill.style.width = '20%';

      setTitle("ì·¨í–¥ ì²´í¬", "í‰ì†Œ ì‹«ì–´í•˜ê±°ë‚˜ í”¼í•˜ê³  ì‹¶ì€ ë§›ì€?", "Step 1/3");

      // ì´ë¯¸ì§€ë¥¼ í¬ê²Œ í•˜ê³  ì„¤ëª…ì„ ì œê±°í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ê°•ì¡°

      mainContent.innerHTML = `

        <div class="taste-grid">

            <button class="taste-btn" onclick="selectTaste('spicy')">

                <img src="./spicy.jpeg" alt="ë§¤ìš´ë§›" class="taste-img">

                <strong>ë§¤ìš´ë§›</strong>

            </button>

            <button class="taste-btn" onclick="selectTaste('sour')">

                <img src="./sour.jpeg" alt="ì‹ ë§›" class="taste-img">

                <strong>ì‹ ë§›</strong>

            </button>

            <button class="taste-btn" onclick="selectTaste('sweet')">

                <img src="./sweet.jpeg" alt="ë‹¨ë§›" class="taste-img">

                <strong>ë‹¨ë§›</strong>

            </button>

            <button class="taste-btn" onclick="selectTaste('cooling')">

                <img src="./cool.jpeg" alt="ì²­ëŸ‰ê°" class="taste-img">

                <strong>ì²­ëŸ‰ê°</strong>

            </button>

        </div>

        <button class="wide-btn" style="margin-top:12px; justify-content:center;" onclick="selectTaste('none')">

            <strong>âŒ íŠ¹ë³„íˆ ê°€ë¦¬ëŠ” ë§› ì—†ìŒ</strong>

        </button>

        <div class="nav"><button class="btn" onclick="setView('menu')">ì·¨ì†Œ</button></div>

      `;

    }

  // 3. ë°”ë”” ìŠ¤ìºë„ˆ (SVG ëŒ€ì‹  ë‹´ë¹„ ìºë¦­í„° ì´ë¯¸ì§€ ì‚½ì…)

    else if (state.view === 'scanner_parts') {

       barFill.style.width = '50%';

       setTitle("ë°”ë”” ìŠ¤ìºë„ˆ", "ë³¸ì¸ì˜ ê´€ë¦¬í•˜ê³  ì‹¶ì€ ë¶€ìœ„ë¥¼ ì„ íƒí•˜ì„¸ìš”", "Step 2/3");

       mainContent.innerHTML = `

        <div class="scanner-layout">

            <div class="scanner-left" style="position: relative;">

                <img src="./dambi.png" alt="ë‹´ë¹„ ìºë¦­í„°" class="body-svg" style="max-height: 300px; width: auto;">

                

                <svg class="body-svg" viewBox="0 0 200 320" xmlns="http://www.w3.org/2000/svg" style="position: absolute; top: 0; left: 0; pointer-events: none;">

    <g fill="none">

        <circle id="hlt-head" class="hlt" cx="130" cy="50" r="45" />

        

        <rect id="hlt-throat" class="hlt" x="110" y="80" width="35" height="25" rx="5" />

        

        <rect id="hlt-upper" class="hlt" x="100" y="110" width="60" height="40" rx="10" />

        

        <rect id="hlt-lower" class="hlt" x="98" y="150" width="65" height="45" rx="10" />

        

        <ellipse id="hlt-whole" class="hlt" cx="130" cy="110" rx="60" ry="100" stroke-width="5" />

    </g>

</svg>

            </div>



            <div class="scanner-right">

                <button id="btn-head" class="part-btn" onclick="selectPart('head')" 

                    onmouseenter="setHighlight('head', true)" onmouseleave="setHighlight('head', false)">

                    <span>ë¨¸ë¦¬ / ì •ì‹ </span> <span>></span>

                </button>

                <button id="btn-throat" class="part-btn" onclick="selectPart('throat')" 

                    onmouseenter="setHighlight('throat', true)" onmouseleave="setHighlight('throat', false)">

                    <span>ëª© / ê¸°ê´€ì§€</span> <span>></span>

                </button>

                <button id="btn-upper" class="part-btn" onclick="selectPart('upper')" 

                    onmouseenter="setHighlight('upper', true)" onmouseleave="setHighlight('upper', false)">

                    <span>ìœ—ë°° / ìœ„, ê°„</span> <span>></span>

                </button>

                <button id="btn-lower" class="part-btn" onclick="selectPart('lower')" 

                    onmouseenter="setHighlight('lower', true)" onmouseleave="setHighlight('lower', false)">

                    <span>ì•„ë«ë°° / ëŒ€ì¥, ì‹ ì¥</span> <span>></span>

                </button>

                <button id="btn-whole" class="part-btn" onclick="selectPart('whole')" 

                    onmouseenter="setHighlight('whole', true)" onmouseleave="setHighlight('whole', false)">

                    <span>ì „ì‹ ìˆœí™˜ (í˜ˆì•¡ìˆœí™˜)</span> <span>></span>

                </button>

            </div>

        </div>

        <div class="nav"><button class="btn" onclick="setView('select_taste')">ì´ì „</button></div>

       `;

    }    // 4. êµ¬ì²´ì  ì¦ìƒ ì„ íƒ

    else if (state.view === 'scanner_symptoms') {

      barFill.style.width = '75%';

      const data = TEA_DB[state.selectedCategory];

      setTitle(data.label, "êµ¬ì²´ì ì¸ ì¦ìƒì„ ì„ íƒí•´ì£¼ì„¸ìš”.", "Step 3/3");



      let html = `<div class="symptom-list">`;

      data.symptoms.forEach((item, idx) => {

        html += `<button class="symptom-btn" onclick="showResult(${idx})"><span>${item.txt}</span><span style="color:#ccc;">></span></button>`;

      });

      html += `</div>

        <div class="nav">

          <button class="btn" onclick="setView('scanner_parts')">ì´ì „</button>

        </div>`;

      mainContent.innerHTML = html;

    }

    // 5. ê²°ê³¼ í™”ë©´ (ë ˆì‹œí”¼ 2ê°œ)

    else if (state.view === 'result') {

      barFill.style.width = '100%';

      const result = state.selectedResult;

      const modifiedRecipe = getModifiedRecipe(result.recipe, result.tea, state.dislikedTaste);

      

      let dislikeLabel = "";

      if(state.dislikedTaste === 'spicy') dislikeLabel = "ë§¤ìš´ë§› ì œì™¸";

      else if(state.dislikedTaste === 'sour') dislikeLabel = "ì‹ ë§› ì œì™¸";

      else if(state.dislikedTaste === 'sweet') dislikeLabel = "ë‹¨ë§› ì œì™¸";

      else if(state.dislikedTaste === 'cooling') dislikeLabel = "ì²­ëŸ‰ê° ì œì™¸";



      setTitle("ì²˜ë°© ê²°ê³¼", "íšŒì›ë‹˜ì„ ìœ„í•œ ë§ì¶¤ ì°¨ì…ë‹ˆë‹¤.", "ì™„ë£Œ");



      mainContent.innerHTML = `

        <section class="result">

          <div class="box">

            <div class="result-title">Today's Tea</div>

            <h2 class="tea-name">${result.tea}</h2>

            <p class="tea-desc">"${result.desc}"</p>



            <!-- ì˜¤ë¦¬ì§€ë„ ë ˆì‹œí”¼ -->

            <div class="recipe-card original">

              <span class="recipe-label og">ORIGINAL RECIPE</span>

              <div>${result.recipe}</div>

            </div>



            <!-- ìˆ˜ì • ë ˆì‹œí”¼ (ì¡°ê±´ë¶€ ë Œë”ë§) -->

            ${modifiedRecipe ? `

            <div class="recipe-card modified">

              <span class="recipe-label mod">CUSTOM (${dislikeLabel})</span>

              <div>${modifiedRecipe}</div>

            </div>` : ''}



            <div class="tag-container">

              ${result.tags.map(tag => `<span class="tag">#${tag}</span>`).join('')}

            </div>

          </div>



          <div style="display:flex; gap:8px; margin-top:10px;">
              <button class="btn" onclick="setView('scanner_parts')">ë‹¤ë¥¸ ì¦ìƒ ë³´ê¸°</button>

              <button class="btn" onclick="setView('menu')">ì²˜ìŒìœ¼ë¡œ</button>              

          </div>

          <div class="nav" style="padding-top:10px;">
<button class="btn capture" onclick="captureResult('app', '${result.tea}_ì²˜ë°©ì „')">ğŸ“· ì €ì¥</button>

              <button class="btn primary" onclick="shareResult('${result.tea}')">ê³µìœ í•˜ê¸°</button>

          </div>

        </section>

      `;

    }

  }



  // Logic Functions

  window.selectTaste = (taste) => { state.dislikedTaste = taste; state.view = 'scanner_parts'; render(); };

  window.selectPart = (key) => { state.selectedCategory = key; state.view = 'scanner_symptoms'; render(); };

  window.showResult = (idx) => { state.selectedResult = TEA_DB[state.selectedCategory].symptoms[idx]; state.view = 'result'; render(); };

  window.setView = (viewName) => { state.view = viewName; render(); };



  // Utils

  window.captureResult = (elementId, fileName) => {

    const element = document.getElementById(elementId);

    const btns = element.querySelectorAll('.btn, .icon-btn, .wide-btn');

    btns.forEach(b => b.style.opacity = '0');

    html2canvas(element, { backgroundColor: "#fff", scale: 2 }).then(canvas => {

      const link = document.createElement('a');

      link.download = fileName + '.png';

      link.href = canvas.toDataURL();

      link.click();

      btns.forEach(b => b.style.opacity = '1');

    }).catch(() => {

      alert("ì˜¤ë¥˜ë°œìƒ");

      btns.forEach(b => b.style.opacity = '1');

    });

  };



  const REAL_URL = "https://wngml090256-sudo.github.io/wngml090256.github.io/tea.html";

  window.shareResult = async (teaName) => {

    if (navigator.share) {

      try {

        await navigator.share({

          title: 'í‹° í…Œë¼í”¼ ì²˜ë°©ì „',

          text: `ë‚˜ì—ê²Œ í•„ìš”í•œ ì°¨ëŠ” '${teaName}' ì…ë‹ˆë‹¤.`,

          url: REAL_URL

        });

      } catch (e) {}

    } else {

      openShareModal();

    }

  };



  window.openShareModal = () => {

    const modal = document.getElementById('shareModal');

    const input = document.getElementById('shareUrlInput');

    const qr = document.getElementById('qrImage');

    if (input) input.value = REAL_URL;

    if (qr) qr.src = `https://api.qrserver.com/v1/create-qr-code/?size=160x160&data=${encodeURIComponent(REAL_URL)}`;

    modal.classList.remove('hidden');

  };



  window.closeShareModal = (event) => {

    if (event && event.target && event.target.id !== 'shareModal') return;

    document.getElementById('shareModal').classList.add('hidden');

  };



  window.copyShareUrl = () => {

    const el = document.getElementById("shareUrlInput");

    el.select();

    document.execCommand("copy");

    alert("ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.");

  };



  render(); // Start

})();

</script>

</body>

</html>